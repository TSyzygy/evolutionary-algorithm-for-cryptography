<!DOCTYPE html>
<html lang="en">
  <!-- copyright Thomas Simpson, Oct 2020 -->
  <head>
    <title>Evolutionary Algorithm for Cryptography</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="evolution, evolutionary, algorithm, cryptography, decrypt, decryption, cipher, solve, genetic">
    <meta name="description" content="A web-based evolutionary algorithm for decrypting ciphers, written in Javascript. A variety of ciphers are supported and it is fully customisable.">
    <meta name="author" content="TSyzygy">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--<base href="">-->
    <link rel="stylesheet" href="colours.css">
    <link rel="stylesheet" href="dist/style.css">
    <link rel="stylesheet" href="fonts/fonts.css">
  </head>
  <body>

    <div id="page">


      <div id="sidebar" class="open">
        <section>
          <div>
            <h1>Evolutionary Algorithm for Cryptography</h1>
            <button type="button" class="square" id="close-sidebar">&times;</button>
          </div>
          <div>
            <h4>Populations:</h4>
            <button type="button" class="square" id="open-add-population-modal">&plus;</button>
          </div>
          <nav id="population-buttons"></nav>
          <p id="no-populations-message">No populations.</p>
        </section>
      </div>


      <div id="main">
        
        <!-- status bar at top -->
        <section id="top">
          <div id="open-sidebar-container">
            <button id="open-sidebar">Menu</button>
          </div>
          <div id="status">
            <h2>Status</h2>
          </div>
        </section>

        <!-- template for population pages -->
        <template id="population-page-template">
          <section>
            <div class="population-page">

              <div class="top-bar">
                <h2 data-dp="name"></h2>
                <div class="controls">
                  <button type="button" class="toggle-button"><span class="run-text">Run &rtrif;</span class="stop-text"><span class="stop-text">Stop &squf;</span></button>
                  <button type="button" class="step-button">Step &plus;</button>
                </div>
                <div class="current">
                  <p>Gen <code data-dp="genNum">0</code>, <span data-dp="state"></span></p>
                </div>
              </div>

              <nav>
                <button data-target="config" class="open">Config</button>
                <button data-target="decryptions">Decryptions</button>
                <button data-target="population">Population</button>
              </nav>

              <div class="sub-pages">
                <div class="config open">
                  <h3>Config</h3>
                  <div class="description">
                    <h4>Description</h4>
                    <p data-dp="description"></p>
                  </div>
                  <div class="cipher-config">
                    <h4>Cipher config</h4>
                    <p data-dp="cipherName"></p>
                    <table data-dp="cipherOptions">
                      
                    </table>
                  </div>
                  <div class="evolution">
                    <h4>Evolution config</h4>
                    <table>
                      <tr>
                        <td>Population size:</td>
                        <td data-dp="populationSize"></td>
                      </tr>
                      <tr>
                        <td>Children per parent:</td>
                        <td data-dp="childrenPerParent"></td>
                      </tr>
                      <tr>
                        <td>Random per generation:</td>
                        <td data-dp="randomPerGeneration"></td>
                      </tr>
                      <tr>
                        <td>Allow duplicates:</td>
                        <td data-dp="allowDuplicates"></td>
                      </tr>
                    </table>
                  </div>
                  <div class="messages">
                    <h4>Messages</h4>
                    <div data-dp="messages">
  
                    </div>
                  </div>
                  <div class="export">
                    <h4>Export</h4>
                    <p>Config only: </p>
                    <button type="button" data-dp="downloadConfig" disabled>Download .json file</button>
                    <button type="button" data-dp="copyConfig" disabled>
                      <span class="default">Copy JSON to clipboard</span>
                      <span class="success">Copied!</span>
                      <span class="failure">Copy failed</span>
                    </button>
                    <p>Config and population history: </p>
                    <button type="button" data-dp="downloadPopulation" disabled>Download .json file</button>
                    <button type="button" data-dp="copyPopulation" disabled>
                      <span class="default">Copy JSON to clipboard</span>
                      <span class="success">Copied!</span>
                      <span class="failure">Copy failed</span>
                    </button>
                    <!--<p>Export config only: </p><input type="text" data-dp="configExport" value="Waiting for initialisation to finish" disabled>
                    <p>Export config and population history: </p><input type="text" data-dp="populationExport" value="Click to generate export" disabled>-->
                  </div>
                </div>
  
                <div class="decryptions">
                  <h3>Decryptions</h3>
                  <p>Key: <input type="text" data-dp="keyInput" class="monospace" width="100px"></p>
                  <p>Score: <code data-dp="keyScore"></code></p>
                  <p>Decryption:</p>
                  <div data-dp="keyDecryptions">
                    
                  </div>
                </div>
  
                <div class="population">
                  <h3>Population</h3>
                </div>
              </div>

            </div>
          </section>
        </template>

        <div id="population-pages">
          
        </div>

      </div>


    </div>


    <section id="add-population-modal" class="modal">
      <div>
        <div>

          <form id="add-population-form" name="new-population-form" autocomplete="off" autocapitalize="words" onsubmit="return false">

            <header>
              <h4>Add population</h4>
              <button type="reset" class="square" id="close-add-population-modal">&times;</button>
            </header>

            <div id="add-population-main">
              <div id="add-population-menu" class="modal-page open">
                <div id="create-population">
                  <h5>Create population from blank</h5>
                  <button type="button" id="open-new-population-menu">New population &rarr;</button><br>
                  <button type="button" disabled>New populations in bulk &rarr;</button>
                </div>
                <div id="import-population">
                  <h5>Import population</h5>
                  <div id="population-from-file">
                    <label for="population-file-import">From file: </label>
                    <input type="file" id="population-file-import" accept=".json">
                    <button type="button" disabled>Next &rarr;</button>
                  </div>
                  <div id="population-from-text">
                    <label for="population-text-input">From text: </label>
                    <input type="text" id="population-text-input" class="monospace small">
                    <button type="button" disabled>Next &rarr;</button>
                  </div>
                </div>
              </div>
    
              <div id="new-population-menu" class="modal-page">
                <div>
                  <h5>Population info</h5>
                  <div class="data-entry">
                    <label for="population-name-input">Name: </label><input type="text" id="population-name-input" name="name" maxlength="32" required>
                  </div>
                  <div class="data-entry">
                    <label for="population-description-input">Description (optional):</label><input type="text" id="population-description-input" name="description" autocapitalize="sentences" maxLength="256" rows="2">
                  </div>
                </div>
                
                <div id="algorithm-options">
                  <h5>Algorithm options</h5>
                  <div class="data-entry">
                    <label for="population-size">Population size: </label>
                    <input type="number" id="population-size" name="population-size" max="1000" min="1" value="20" required>
                  </div>
                  <div class="data-entry">
                    <label for="children-per-parent">Children per parent: </label>
                    <input type="number" id="children-per-parent" name="children-per-parent" max="20" min="1" value="2" required>
                  </div>
                  <div class="data-entry">
                    <label for="random-per-generation">Random per generation: </label>
                    <input type="number" id="random-per-generation" name="random-per-generation" max="500" min="1" value="5" required>
                  </div>
                  <div class="data-entry">
                    <label for="duplicates-allowed">Duplicates allowed? </label>
                    <input type="checkbox" id="duplicates-allowed" name="duplicates-allowed">
                  </div>
                </div>

                <div id="messages-for-decryption">
                  <h5>Message(s) for decryption</h5>
                  <p>Enter up to 12 messages. The algorithm will search for a decryption which applies best to all of them. If they are encrypted in different ways, a separate population must be made for each message.</p>
                  <div>
                    <div id="messages">
                      <div>
                        <input type="text" placeholder="message" class="monospace small" required>
                        <p><span class="monospace">0000</span> chars</p>
                      </div>
                    </div>
                    <button type="button" id="add-message">&plus; Add message</button>
                    <template id="message-input-template">
                      <div>
                        <input type="text" placeholder="message" class="monospace small" required>
                        <button type="button">&times;</button>
                        <p><span class="monospace">0000</span> chars</p>
                      </div>
                    </template>
                  </div>
                </div>

                <div id="cipher-options">
                  <h5>Cipher options</h5>
                  <div id="cipher-choices"  class="data-entry">
                    <label for="cipher-name">Cipher type:</label>
                    <select id="cipher-name" name="cipher-name" required>
                      <option value="">Choose cipher...</option>
                      <option value="vigenere">Vigenere</option>
                      <option value="transposition">Transposition</option>
                      <option value="monoalphabetic">Monoalphabetic substitution</option>
                      <option value="one-time-pad">One-time pad</option>
                      <option value="hill">Hill</option>
                    </select>
                  </div>
                  <div id="cipher-specific-options">

                    <div data-cipher-name="vigenere">
                      <div class="data-entry">
                        <label for="vigenere-keylength">Keylength:</label>
                        <input type="number" name="keylength" id="vigenere-keylength" class="required-for-cipher" max="100" min="2" value="8">
                      </div>
                      <div class="data-entry">
                        <label for="vigenere-n">Fitness evaluation method:</label>
                        <select name="n" id="vigenere-n" class="required-for-cipher">
                          <option value="">Select fitness method...</option>
                          <option value="1">Letter frequencies (fastest)</option>
                          <option value="2">Bigram score</option>
                          <option value="3">Trigram score</option>
                          <option value="4">Quadgram score (most reliable)</option>
                          <option value="5">Quintgram score</option>
                        </select>
                      </div>
                    </div>

                    <div data-cipher-name="transposition">
                      <div class="data-entry">
                        <label for="transposition-keylength">Keylength:</label>
                        <input type="number" name="keylength" id="transposition-keylength" class="required-for-cipher" max="100" min="2" value="8">
                      </div>
                      <div class="data-entry">
                        <label for="transposition-n">Fitness evaluation method:</label>
                        <select name="n" id="transposition-n" class="required-for-cipher">
                          <option value="">Select fitness method...</option>
                          <option value="2">Bigram score</option>
                          <option value="3">Trigram score</option>
                          <option value="4">Quadgram score (recommended)</option>
                          <option value="5">Quintgram score</option>
                        </select>
                      </div>
                    </div>

                    <div data-cipher-name="monoalphabetic">
                      <div class="data-entry">
                        <label for="monoalphabetic-n">Fitness evaluation method:</label>
                        <select name="n" id="monoalphabetic-n" class="required-for-cipher">
                          <option value="">Select fitness method...</option>
                          <option value="2">Bigram score</option>
                          <option value="3">Trigram score</option>
                          <option value="4">Quadgram score (recommended)</option>
                          <option value="5">Quintgram score</option>
                        </select>
                      </div>
                    </div>

                    <div data-cipher-name="one-time-pad">
                      <p>One-time pad not yet implemented</p>
                    </div>

                    <div data-cipher-name="hill">
                      <p>Hill cipher not yet implemented</p>
                    </div>

                  </div>
                </div>

                <div>
                  <h5>Finish</h5>
                  <button type="submit" id="add-population-submit">Create population &rarr;</button>
                </div>
              </div>
            </div>

            <footer>
              <button type="button" id="population-modal-back-button" disabled>&larr; Back</button>
            </footer>

          </form>
          
        </div>
      </div>
    </section>

    <script src="functionality-checks.js"></script>
    <script src="cipher-functions.js"></script>
    <script src="population-control.js"></script>
    <script src="assets.js"></script>
    <script src="interface.js"></script>

  </body>
</html>
